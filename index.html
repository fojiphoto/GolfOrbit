<!DOCTYPE html>
<html lang="en-us">
  <head>
<link rel="manifest" href="manifest.json">
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Player | Golf Orbit</title>
  <script src="https://assets.msn.com/staticsb/statics/latest/msstart-games-sdk/msstart-v1.0.0-rc.20.min.js"></script>
</head>
  <body style="text-align: center; padding: 0; border: 0; margin: 0;">
    <canvas id="unity-canvas" width=1920 height=1080 tabindex="-1" style="width: 1920px; height: 1080px; background: #000000"></canvas>
    <script src="Build/9853637125e801e9aae48e78dbbdcfca.loader.js"></script>
    <script>
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        // Mobile device style: fill the whole browser client area with the game canvas:
        var meta = document.createElement('meta');
        meta.name = 'viewport';
        meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
        document.getElementsByTagName('head')[0].appendChild(meta);

        var canvas = document.querySelector("#unity-canvas");
        canvas.style.width = "100%";
        canvas.style.height = "100%";
        canvas.style.position = "fixed";

        document.body.style.textAlign = "left";
      }

      createUnityInstance(document.querySelector("#unity-canvas"), {
        dataUrl: "Build/97bf6aad875b0c6b2d015360d1d2911c.data.unityweb",
        frameworkUrl: "Build/afdd5818e534a95bb786783c2dc9ac5d.framework.js.unityweb",
        codeUrl: "Build/070841f5bb2a2672093800b5fd1f2313.wasm.unityweb",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "PinpinTeam",
        productName: "Golf Orbit",
        productVersion: "1.25.39",
        // matchWebGLToCanvasSize: false, // Uncomment this to separately control WebGL canvas render size and DOM element size.
        // devicePixelRatio: 1, // Uncomment this to override low DPI rendering on high DPI displays.
      });
    </script>
  
<script>
    let interstitialAdInstance = null;
    let rewardedAdInstance = null;
    let isLoadingRewarded = false;

  function LoadInterstitialAd() {
    $msstart.loadAdsAsync().then(ad => {
      interstitialAdInstance = ad;
      console.log('Interstitial loaded');
    }).catch(err => {
      console.error('Interstitial load failed', err);
      setTimeout(LoadInterstitialAd, 60000);
    });
  }

  function ShowInterstitialAd() {
    if (!interstitialAdInstance) {
      console.warn('Interstitial ad not loaded');
      return;
    }
    $msstart.showAdsAsync(interstitialAdInstance.instanceId).then(ad => {
      ad.showAdsCompletedAsync.then(() => {
        console.log('Interstitial completed');
        interstitialAdInstance = null;
        LoadInterstitialAd();
      }).catch(err => {
        console.error('Interstitial show error', err);
        interstitialAdInstance = null;
        setTimeout(LoadInterstitialAd, 60000);
      });
    }).catch(err => {
      console.error('ShowAdsAsync error', err);
      interstitialAdInstance = null;
      setTimeout(LoadInterstitialAd, 60000);
    });
  }

function LoadRewardedAd() {
  if (isLoadingRewarded || rewardedAdInstance) {
    console.log('Rewarded ad already loading or loaded.');
    return;
  }
  isLoadingRewarded = true;
  $msstart.loadAdsAsync(true).then(ad => {
    rewardedAdInstance = ad;
    isLoadingRewarded = false;
    console.log('Rewarded ad loaded');
  }).catch(err => {
    isLoadingRewarded = false;
    console.error('Rewarded load failed', err.code, err.message);
    setTimeout(LoadRewardedAd, 60000); // retry after 60s cooldown
  });
}

function ShowRewardedAd() {
  if (!rewardedAdInstance) {
    console.warn('Rewarded ad not loaded');
    return;
  }
  $msstart.showAdsAsync(rewardedAdInstance.instanceId).then(ad => {
    ad.showAdsCompletedAsync.then(() => {
      console.log('Rewarded ad watched fully');
      SendMessage('MSStartIntegration', 'OnRewardedAdComplete');
      rewardedAdInstance = null;
      LoadRewardedAd(); // preload next ad
    }).catch(err => {
      console.warn('Rewarded ad skipped or failed', err.code, err.message);
      rewardedAdInstance = null;
      setTimeout(LoadRewardedAd, 60000);
    });
  }).catch(err => {
    console.error('ShowAdsAsync error', err.code, err.message);
    rewardedAdInstance = null;
    setTimeout(LoadRewardedAd, 60000);
  });
}

</script>

</body>
</html>
